<!-- Ignite Spring configuration file to startup Ignite cache. This file 
	demonstrates how to configure cache using Spring. Provided cache will be 
	created on node startup. Use this configuration file when running HTTP REST 
	examples (see 'examples/rest' folder). When starting a standalone node, you 
	need to execute the following command: {IGNITE_HOME}/bin/ignite.{bat|sh} 
	examples/config/example-cache.xml When starting Ignite from Java IDE, pass 
	path to this file to Ignition: Ignition.start("examples/config/example-cache.xml"); -->
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
        	http://www.springframework.org/schema/beans
        	http://www.springframework.org/schema/beans/spring-beans.xsd"
	default-autowire="byName">

	<bean id="algoMgrIgniteClientConfig" class="org.apache.ignite.configuration.IgniteConfiguration"
		scope="singleton">
		<property name="clientMode" value="true" />
		<property name="gridName" value="${algoMgr.ignite.server.gridName:AtsIgniteClient}" />
		<!-- <property name="peerClassLoadingEnabled" value="true" /> -->

		<!-- Explicitly configure TCP communication SPI changing local port number 
			for the nodes from the first cluster. -->
		<property name="communicationSpi">
			<bean class="org.apache.ignite.spi.communication.tcp.TcpCommunicationSpi">
				<property name="localPort"
					value="${algoMgr.ignite.server.communication.localPort:47100}" />
			</bean>
		</property>

		<!-- Explicitly configure TCP discovery SPI to provide list of initial 
			nodes. -->
		<property name="discoverySpi">
			<bean class="org.apache.ignite.spi.discovery.tcp.TcpDiscoverySpi">
				<!-- Initial local port to listen to. -->
				<property name="localPort"
					value="${algoMgr.ignite.server.discovery.localPort:47500}" />

				<!-- Changing local port range. This is an optional action. -->
				<property name="localPortRange"
					value="${algoMgr.ignite.server.discovery.localPortRange:20}" />

				<property name="ipFinder">
					<!-- Ignite provides several options for automatic discovery that can 
						be used instead os static IP based discovery. For information on all options 
						refer to our documentation: http://apacheignite.readme.io/docs/cluster-config -->
					<bean
						class="org.apache.ignite.spi.discovery.tcp.ipfinder.vm.TcpDiscoveryVmIpFinder">
						<property name="addresses">
							<list>
								<!-- In distributed environment, replace with actual host IP address. -->
								<value>${algoMgr.ignite.server.address:127.0.0.1:47500..47509}
								</value>
							</list>
						</property>
					</bean>
				</property>

				<!-- Client node can finish start only if there are running servers in 
					topology.. https://apacheignite.readme.io/docs/clients-vs-servers -->
				<property name="forceServerMode" value="true" />
			</bean>
		</property>
	</bean>

	<bean id="algoMgrIgnite" class="org.apache.ignite.IgniteSpringBean"
		scope="singleton">
		<property name="configuration" ref="algoMgrIgniteClientConfig" />
	</bean>

	<bean id="algoManagerCacheService" class="ats.algo.cache.ignite.AlgoManagerIgniteCache"
		init-method="init">
		<property name="algoMgrIgnite" ref="algoMgrIgnite" />
	</bean>

</beans>
